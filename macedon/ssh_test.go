package macedon

import (
	"time"
	"testing"
)

const test_key string = `
-----BEGIN RSA PRIVATE KEY-----
MIIEowIBAAKCAQEA2AdfHstIMKswqD908kefu9DNRoGLB+icW9rgE110Vffw1D1D
F+3tv1Vb1LLlTKzkmjxDPTWRxTUG9HN4Xw+BZUVcyUhmH8jPlWCRDZejCuYH8r8o
YYVp/DV5mY8dkFEUx86e0ipmSCFSw2+uGBjFpRBv8oUpWSZOysM36MK6qU1awGGF
nt7LT32A2d2kUpESfUPWoHGyA0r4Ex55KlgY/KAy+pzfrdsw06rRmdIJgeAlRjpe
+IgGtdwGLPLttnFRlwhLPdzO+gZFAZe2QBjO8qciPInjhnEkD1sLBIpXgVxMDUWg
ici/rL0MI1gaJ/mwlfoG4w1CQoHHovjCXoG9/wIBIwKCAQEAjfY3MX5FYc+VANk+
OM/7QOhMYYhUDILqaD9gDLnBelJ5sAsANEvlYHnr44uAvVusKtck3xSS/e+lfBFd
us+szYVaOyDypywwo/2hJjBydOBOXbDRZKghE3OZDSOIdMeRUBoQmLzG3vFTpQA/
NGgM2i9fghz96iB866TbmPT+Uf5sQ6o0Af76aW8a6HgmRTyhO/nmE78zYbtGs8I9
ktGXfIJSrwwT9i7HCqOERMTLXxyBug87KK+7ALI3NzmA77yW9DT8bigE8Df3BN9v
sufmQJMXpLGS8Nr+Z7pRQvlR+3Yn4PqCcRNx+4pH5evuczAskX4cYRqq6sXZDfkS
uKWXswKBgQD7fTK/g8wQsz+BOj/hcEdv6LY8PTO2JqyQaUp79c77JKjKYIwLOlqs
mWV0Xxku9A9EbiHAUWA5VGybkZExBbj12vgT6Tamv2QSvhT2WpqgkGP+iZGpV1GW
XzeYsZPChIZqn9q+kx9aCtdLJaTgeecCnScuGo1jIalRV2KqoVIp8wKBgQDb51hK
cRRIreLWrSm1KwOiF+TM90eMR+WX5jH4jMSbfquGmtHtuhfxKhTh3TRXKZpeN2Wd
rAYgHZfe7k0DnPJq5EUmgH+E41gpq2Zj1T6um9Kbi9O+wJqmYDRxGZFxRoZAkX5e
P3WLqK8nDx+tbhdIwmDaHniug+4r/qvDmRIyxQKBgQD0TbxFA7BKvMFY9sG2bRIy
MoUkkzmMYBVZFdNT2NeyI5ynVnlp/iwyo6RiawKFYh11rNBUbE7YmyetERCzR2M3
+UjC4ozcf2iHPE7gr8loxseJjPPmVNLp2NbsGjfERjlu5G4YNyXFLxpI//9Admth
n/osyVYlyO2feXXKU5GlFwKBgQCQghVyv1Z450vsKKZhHEQ3UYe55FOWsudVMN8C
ayIdChjyDfeq2WAww+HWQOfhgb02mW6pcQtW7uAkyHvAi7U+7ccKrDaKhsToLs5B
msLKg6eoC23jwGWgiFz53ZoXPPkjHcgSDHHQze9xcFalKxadhwxyFAYpieWn4d6W
eohNPwKBgCPZ2FOO10J8uCftGz4ld+JYQpNf9/FzSp7gEGTIH5E7zFaJT6Zm8P8L
C+3q5Spf7w44TKJ959sMoR4ZprGCXWk9QEyMurXkx/guEsSgPHN5viQaiPv0Hghm
KEICMCqKwlGFmoGDByechMcf0EXMrh8PGeHxh68sg0hdPhMqWj39
-----END RSA PRIVATE KEY-----
`

const test_key_bad string = `
-----BEGIN RSA PRIVATE KEY-----
GIIEowIBAAKCAQEA2AdfHstIMKswqD908kefu9DNRoGLB+icW9rgE110Vffw1D1D
F+3tv1Vb1LLlTKzkmjxDPTWRxTUG9HN4Xw+BZUVcyUhmH8jPlWCRDZejCuYH8r8o
YYVp/DV5mY8dkFEUx86e0ipmSCFSw2+uGBjFpRBv8oUpWSZOysM36MK6qU1awGGF
nt7LT32A2d2kUpESfUPWoHGyA0r4Ex55KlgY/KAy+pzfrdsw06rRmdIJgeAlRjpe
+IgGtdwGLPLttnFRlwhLPdzO+gZFAZe2QBjO8qciPInjhnEkD1sLBIpXgVxMDUWg
ici/rL0MI1gaJ/mwlfoG4w1CQoHHovjCXoG9/wIBIwKCAQEAjfY3MX5FYc+VANk+
OM/7QOhMYYhUDILqaD9gDLnBelJ5sAsANEvlYHnr44uAvVusKtck3xSS/e+lfBFd
us+szYVaOyDypywwo/2hJjBydOBOXbDRZKghE3OZDSOIdMeRUBoQmLzG3vFTpQA/
NGgM2i9fghz96iB866TbmPT+Uf5sQ6o0Af76aW8a6HgmRTyhO/nmE78zYbtGs8I9
ktGXfIJSrwwT9i7HCqOERMTLXxyBug87KK+7ALI3NzmA77yW9DT8bigE8Df3BN9v
sufmQJMXpLGS8Nr+Z7pRQvlR+3Yn4PqCcRNx+4pH5evuczAskX4cYRqq6sXZDfkS
uKWXswKBgQD7fTK/g8wQsz+BOj/hcEdv6LY8PTO2JqyQaUp79c77JKjKYIwLOlqs
mWV0Xxku9A9EbiHAUWA5VGybkZExBbj12vgT6Tamv2QSvhT2WpqgkGP+iZGpV1GW
XzeYsZPChIZqn9q+kx9aCtdLJaTgeecCnScuGo1jIalRV2KqoVIp8wKBgQDb51hK
cRRIreLWrSm1KwOiF+TM90eMR+WX5jH4jMSbfquGmtHtuhfxKhTh3TRXKZpeN2Wd
rAYgHZfe7k0DnPJq5EUmgH+E41gpq2Zj1T6um9Kbi9O+wJqmYDRxGZFxRoZAkX5e
P3WLqK8nDx+tbhdIwmDaHniug+4r/qvDmRIyxQKBgQD0TbxFA7BKvMFY9sG2bRIy
MoUkkzmMYBVZFdNT2NeyI5ynVnlp/iwyo6RiawKFYh11rNBUbE7YmyetERCzR2M3
+UjC4ozcf2iHPE7gr8loxseJjPPmVNLp2NbsGjfERjlu5G4YNyXFLxpI//9Admth
n/osyVYlyO2feXXKU5GlFwKBgQCQghVyv1Z450vsKKZhHEQ3UYe55FOWsudVMN8C
ayIdChjyDfeq2WAww+HWQOfhgb02mW6pcQtW7uAkyHvAi7U+7ccKrDaKhsToLs5B
msLKg6eoC23jwGWgiFz53ZoXPPkjHcgSDHHQze9xcFalKxadhwxyFAYpieWn4d6W
eohNPwKBgCPZ2FOO10J8uCftGz4ld+JYQpNf9/FzSp7gEGTIH5E7zFaJT6Zm8P8L
C+3q5Spf7w44TKJ959sMoR4ZprGCXWk9QEyMurXkx/guEsSgPHN5viQaiPv0Hghm
KEICMCqKwlGFmoGDByechMcf0EXMrh8PGeHxh68sg0hdPhMqWj39
-----END RSA PRIVATE KEY-----
`
func TestInitSshContextOk(t *testing.T) {
	log := testInitlog()
	if log == nil {
		t.Fatal("init log failed")
	}
	defer testDestroylog()

	_, err := InitSshContext(test_key, "root", time.Second * 5, log)
	if err != nil {
		t.Fatal("init ssh context failed: ", err)
	}
	t.Log("init ssh context ok")
}
